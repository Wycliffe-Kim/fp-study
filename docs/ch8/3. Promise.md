# Promise

이러한 비동기 처리의 문제를 적절하게 해결하는 방법 중에 첫 번째 방법은 `Promise` 모나드를 사용하는 것이다.

Promise 모나드는 다음과 같은 모습으로 되어 있다.

``` javascript
Promise.of(비동기 작업).map(func1).map(func2).catch(errfunc);
```

위와 같이 `Promise`는 비동기 작업이 정상적으로 처리된 경우와 아닌 경우를 함수형 프로그래밍에 적합하게 처리할 수 있도록 해준다.

`Promise`는 Promise/A+라는 표준을 채택하여 제작된 모나드이다. 해당 내용은 https://promisesaplus.com/ 에 있다.

그래서 javascript와 python 둘다 동일한 방식으로 사용할 수 있다.

`Promise`는 모나드의 특징을 그대로 갖고 있어서 `map`과 같은 `then` 함수를 갖고 있다. 즉 `Promise`는 `then` 함수를 통해서 함수 체이닝을 이어 나갈 수 있다.

이러한 `Promise`의 예제는 다음과 같다.

``` javascript
// javascript
const log = R.curry((title, message) => console.log(title, message));

getJSONPromise('http://localhost:5555/students')
  .then(R.map((student) => student.grade))
  .then(average)
  .then((grade) => IO.of(grade).map(log('promise success')).run())
  .catch((error) => log('promise fail', error));

// output
// >> promise success 75
```

``` python
# python
log = pydash.curry(lambda title, message: print(title, message))

map = pydash.curry(lambda func, arr: pydash.map_(arr, func))

(get_json_promise('http://localhost:5555/students')
 .then(map(lambda student: student['grade']))
 .then(average)
 .then(lambda grade: IO.of(grade).map(log('promise success')).run())
 .catch(lambda error: log('promise fail', error)))

# output
# >> promise success 75
```